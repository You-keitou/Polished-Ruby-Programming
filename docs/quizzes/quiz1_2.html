<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第1章 1.2 クイズ: True, False, and Nil</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
    <style>
        .question-card {
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        .options {
            list-style: none;
            padding: 0;
        }
        .options li {
            margin: 10px 0;
        }
        .answer-section {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f0f8ff;
            border-radius: 5px;
        }
        .toggle-btn {
            margin-top: 10px;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <header>
        <a href="../index.html">← Back to Index</a>
        <h1>第1章 1.2 クイズ: True, False, and Nil</h1>
    </header>

    <main>
        
        <div class="question-card">
            <h3>Q1. ケース1: 環境変数の落とし穴 (Rails/Env)</h3>
            
            
            <p><strong>要件:</strong><br>環境変数 'ENABLE_FEATURE' を読み込んで、機能のオン/オフを判定したい。\n環境変数がセットされていない場合は、デフォルトで `true` (有効) にしたい。\n環境変数は文字列として返ってくることに注意。</p>
            
            
            
            <pre><code>ENV['ENABLE_FEATURE'] || true</code></pre>
            

            <p>ユーザーが `ENABLE_FEATURE='false'` と設定しました。このコードの評価結果はどうなる？</p>

            <ul class="options">
                <li><strong>A:</strong> true (有効)</li>
                <li><strong>B:</strong> false (無効)</li>
                
                <li><strong>C:</strong> \</li>
                
            </ul>

            <button class="toggle-btn" onclick="document.getElementById('ans-0').style.display = 'block'">答えを見る</button>

            <div id="ans-0" class="answer-section">
                <p><strong>正解: C</strong></p>
                <hr>
                <p>正解は C (\</p>
            </div>
        </div>
        
        <div class="question-card">
            <h3>Q2. ケース2:破壊的メソッドとぼっち演算子</h3>
            
            
            <p><strong>要件:</strong><br>ユーザー入力を正規化したい。「空白の除去(strip!)」と「小文字化(downcase!)」をチェーンさせたい。</p>
            
            
            
            <pre><code>input = \</code></pre>
            

            <p>inputに余計な空白が **なかった** 場合、normalized の値は何になる？</p>

            <ul class="options">
                <li><strong>A:</strong> \</li>
                <li><strong>B:</strong> nil</li>
                
                <li><strong>C:</strong> \</li>
                
            </ul>

            <button class="toggle-btn" onclick="document.getElementById('ans-1').style.display = 'block'">答えを見る</button>

            <div id="ans-1" class="answer-section">
                <p><strong>正解: B</strong></p>
                <hr>
                <p>正解は B (nil) です。\n\n1. `input.strip!` が呼ばれます。空白がないので `nil` が返ります。\n2. `nil&.downcase!` が呼ばれます。`&.` なので `nil` が返ります。\n\n結果、`normalized` は `nil` になります。\nチェーンを使いたいなら、破壊的でない `strip.downcase` を使うか、`tap` を活用する必要があります。</p>
            </div>
        </div>
        
        <div class="question-card">
            <h3>Q3. ケース3: 設定値の 3-State (ActiveModel)</h3>
            
            
            <p><strong>要件:</strong><br>ある属性 `admin_flag` があります。この値は `true`, `false`, `nil` のいずれかを取り得ます。\n「値がセットされている（true または false）」かつ「nilではない」ことを判定したい。</p>
            
            
            
            <pre><code>if object.admin_flag\n  # 処理\nend</code></pre>
            

            <p>このコードで「falseがセットされている場合」は処理が実行される？</p>

            <ul class="options">
                <li><strong>A:</strong> 実行される</li>
                <li><strong>B:</strong> 実行されない</li>
                
            </ul>

            <button class="toggle-btn" onclick="document.getElementById('ans-2').style.display = 'block'">答えを見る</button>

            <div id="ans-2" class="answer-section">
                <p><strong>正解: B</strong></p>
                <hr>
                <p>正解は B (実行されない) です。\n\n`false` はRubyにおいて「偽」なので、if文に入りません。\nしかし要件は「値がセットされている（falseも含む）」ことの判定です。\n\nこれを満たすには `!object.admin_flag.nil?` や、Railsなら `present?` ではなく `inclusion validation` など、文脈に応じた「存在チェック」が必要です。\n1.2の問題で扱う「デフォルト値の上書き」もこのパターンです。</p>
            </div>
        </div>
        
        <div class="question-card">
            <h3>Q4. ケース4: ハッシュのキー検索 (API Client)</h3>
            
            
            <p><strong>要件:</strong><br>APIレスポンスのハッシュ `response` から `:status` キーの値を取得したい。\nただし、`:status` キー自体が存在しない場合のみエラーにしたい（値が nil の場合はOK）。</p>
            
            
            
            <pre><code>val = response[:status]\nraise 'Error' unless val</code></pre>
            

            <p>このコードの問題点は？</p>

            <ul class="options">
                <li><strong>A:</strong> 問題ない</li>
                <li><strong>B:</strong> 値が false や nil の時に誤ってエラーになる</li>
                
                <li><strong>C:</strong> シンボルではなく文字列でアクセスすべき</li>
                
            </ul>

            <button class="toggle-btn" onclick="document.getElementById('ans-3').style.display = 'block'">答えを見る</button>

            <div id="ans-3" class="answer-section">
                <p><strong>正解: B</strong></p>
                <hr>
                <p>正解は B です。\n\n`response[:status]` が `nil` を返したとき、それが「キーがないからnil」なのか「値がnilだからnil」なのか、この書き方では区別できません。\nまた、値が `false` の場合も `unless` に引っかかってしまいます。\n\n正解パターン: `response.key?(:status)` または `response.fetch(:status)` を使いましょう。</p>
            </div>
        </div>
        
    </main>

    <footer>
        <p>Generated by Gemini CLI for Polished Ruby Programming</p>
    </footer>
</body>
</html>
